<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Đăng ký</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
          integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
          crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css"
          integrity="sha512-vKMx8UnXk60zUwyUnUPM3HbQo8QfmNx7+ltw8Pm5zLusl1XIfwcxo8DbWCqMGKaWeNxWA8yrx5v3SaVpMvR3CA=="
          crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <link rel="stylesheet" th:href="@{/web-assets/css/style.css}">
</head>
<body>
<header class="bg-dark">
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="/">
                <img src="https://motchilltv.io/logo_motchill.png" alt="" class="logo">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup"
                    aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-between" id="navbarNavAltMarkup">
                <div class="navbar-nav">
                    <a class="nav-link text-white" href="/">Trang chủ</a>
                    <a class="nav-link text-white" href="/phim-bo">Phim bộ</a>
                    <a class="nav-link text-white" href="/phim-le">Phim lẻ</a>
                    <a class="nav-link text-white" href="/phim-chieu-rap">Phim chiếu rạp</a>
                    <a class="nav-link text-white" href="#">Quốc gia</a>
                    <a class="nav-link text-white" href="#">Thể loại</a>
                </div>

                <div>
                    <a class="text-white" href="#">Đăng nhập</a>
                </div>
            </div>
        </div>
    </nav>
</header>

<section class="py-4">
    <div class="container">
        <div class="d-flex justify-content-center align-items-center flex-column">
            <h3 class="mb-3">Đăng ký</h3>
            <form id="form-register" class="p-4 bg-body-tertiary">
                <div class="mb-3 form-group">
                    <label for="email" class="form-label">Email</label>
                    <input type="text" class="form-control" id="email" name="email"/>
                </div>
                <div class="mb-3 form-group">
                    <label for="name" class="form-label">Tên Đăng Nhập</label>
                    <input type="name" class="form-control" id="name" name="name"/>
                </div>
                <div class="mb-3 form-group">
                    <label for="password" class="form-label">Mật Khẩu</label>
                    <input type="password" class="form-control" id="password" name="password"/>
                </div>
                <div class="mb-3 form-group">
                    <label for="confirmPassword" class="form-label">Xác Nhận Mật Khẩu</label>
                    <input type="password" class="form-control" id="confirmPassword" name="confirmPassword"/>
                </div>
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <button type="submit" class="btn btn-primary" id="btn-singUp">Đăng ký</button>
                </div>
            </form>
            <span class="mt-2">Bạn có muốn tạo <a href="/dang-ky" class="text-decoration-underline">tài khoản</a> mới không?</span>
        </div>
    </div>
</section>

<footer class="py-4 bg-dark">
    <div class="container">
        <div class="row">
            <div class="col-4">
                <img src="https://motchilltv.io/logo_motchill.png" alt="" class="logo">
                <p class="text-white mt-3">Motchill - Xem phim Online Vietsub chất lượng cao miễn phí, nhiều thể loại
                    phim phong phú, đặc sắc, giao diện trực quan, thuận tiện, tốc độ tải nhanh, thường xuyên cập nhật
                    các bộ phim mới.</p>
            </div>
            <div class="col">
                <div class="text-white">
                    <h5 class="text-uppercase mb-3 fw-normal">Danh mục</h5>
                    <p>Tin tức</p>
                    <p>Phim chiếu rạp</p>
                    <p>Phim lẻ</p>
                    <p>Phim bộ</p>
                    <p>TV Show</p>
                </div>
            </div>
            <div class="col">
                <div class="text-white">
                    <h5 class="text-uppercase mb-3 fw-normal">Danh mục</h5>
                    <p>Tin tức</p>
                    <p>Phim chiếu rạp</p>
                    <p>Phim lẻ</p>
                    <p>Phim bộ</p>
                    <p>TV Show</p>
                </div>
            </div>
            <div class="col">
                <div class="text-white">
                    <h5 class="text-uppercase mb-3 fw-normal">Danh mục</h5>
                    <p>Tin tức</p>
                    <p>Phim chiếu rạp</p>
                    <p>Phim lẻ</p>
                    <p>Phim bộ</p>
                    <p>TV Show</p>
                </div>
            </div>
            <div class="col">
                <div class="text-white">
                    <h5 class="text-uppercase mb-3 fw-normal">Danh mục</h5>
                    <p>Tin tức</p>
                    <p>Phim chiếu rạp</p>
                    <p>Phim lẻ</p>
                    <p>Phim bộ</p>
                    <p>TV Show</p>
                </div>
            </div>
        </div>
    </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
        integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"
        integrity="sha512-VEd+nq25CkR676O+pLBnDW09R7VQX9Mdiij052gVCp5yVH3jGtH70Ho/UUv4mJDsEdTvqRCFZg0NKGiojGnUCw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script th:src="@{/web-assets/js/main.js}"></script>

<script>
    const formLoginEL = document.getElementById("form-register");
    const emailEl = document.getElementById("email");
    const nameEl = document.getElementById("name");
    const passwordEl = document.getElementById("password");
    const confirmPasswordEl = document.getElementById("confirmPassword");

    function isValidEmail(email) {
        // Regular expression to validate email address
        const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
        return emailRegex.test(email);
    }

    formLoginEL.addEventListener('submit', async (e) => {
        e.preventDefault();

        if (emailEl.value === ""){
            toastr.error("Email không được để trống");
            return;
        }
        if (!isValidEmail(emailEl.value)) {
            toastr.error("Email không đúng định dạng");
            return;
        }

        if (nameEl.value === ""){
            toastr.error("Tên đăng nhập không được để trống");
            return;
        }

        if (passwordEl.value === ""){
            toastr.error("Mật khẩu không được để trống");
            return;
        }

        if (confirmPasswordEl.value === ""){
            toastr.error("Mật khẩu không được để trống");
            return;
        }

        if (passwordEl.value !== confirmPasswordEl.value) {
            toastr.error("Vui lòng nhập lại mật khẩu");
            return;
        }

        console.log(emailEl.value);

        const request = {
            name: nameEl.value,
            mail: emailEl.value,
            password: passwordEl.value,
            confirmPassword: confirmPasswordEl.value,

        }

        try {
            const res = await axios.post('/api/auth/register', request);
            toastr.success("Đăng ký thành công");
            setTimeout(() => {
                window.location.href = '/dang-nhap.html';
            }, 1000);
        } catch (e) {
            toastr.error(e.response.data.message);
        }
    });
</script>
</body>
</html>